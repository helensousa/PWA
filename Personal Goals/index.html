<!DOCTYPE html >
<html >
  <head>
    <link rel="manifest" href="/manifest.webmanifest">
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection">

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

      
    <Link rel= "stylesheet" type="text/css" href= "css/style.css" > 

    <script type="text/javascript">
    console.log ("era para estar aqui")
       //if('serviceWorker' in navigator) {
        console.log('trying to install')
        navigator.serviceWorker.register('service-worker.js').then((res)=>{
          console.log(res, "Service worker registered");
          alert('Instalado');
        }).catch((e) => {
          console.log(e); // "Ah, não!"
      });
      // };
    </script>
    <meta charset="utf-8">
  </head>
  <body>

    <nav>
        <div class="nav-wrapper">
          <a href="#" class="brand-logo center">Personal Goals</a>
          <ul id="nav-mobile" class="left hide-on-med-and-down">
           <!-- <li><a href="sass.html">Sass</a></li>
            <li><a href="badges.html">Components</a></li>
            <li><a href="collapsible.html">JavaScript</a></li>-->
          </ul>
        </div>
    </nav>
    <div id="paginaInicial" hidden="true">
    <div class="search-wrapper focused">
        <input style="width: 200px;" id="search" placeholder="Search">
        <i class="material-icons">search</i>
    </div >
    <div>
        <div id="tela1" class="collection with-header">
            <div class="left hide-on-med-and-down"></div>
              <h1 class="collection-header">Minhas Metas</h1> 
        </div>
        <div class="collection">
            <div id="blank">
            </div>
            <ul id="listaDeMetas" class="lcollectior-item"></ul>
          </div>
        </div>
    <div id="btnadic" class="fixed-action-btn">
      <a class="btn-floating btn-large red">
        <i class="large material-icons" onClick="AddMeta()">add</i>
      </a>
      <ul>
        <li><a class="btn-floating red"><i class="material-icons">insert_chart</i></a></li>
        <li><a class="btn-floating yellow darken-1"><i class="material-icons">format_quote</i></a></li>
        <li><a class="btn-floating green"><i class="material-icons">publish</i></a></li>
        <li><a class="btn-floating blue"><i class="material-icons">attach_file</i></a></li>
      </ul>
    </div>
   </div>

   <div id="paginaCad" hidden="true">
    <form action="#">                                                                                                       
        <div id="tela2" class="row">  
            <p>                                                                           
            <div class="input-field col s12">                                                            
              <input placeholder="Digite sua Meta" id="inputNovaMeta" type="text" class="validate">
              <label for="inputNovaMeta">Meta:</label>
            </div>
          </p>

            <div class="input-field col s12">
              <input style="width:25%" id="inputNovoInicio" type="date" class="validate">
              <label for="inputNovoInicio">Previsão de Inicio:</label>
            </div>
          </div>
        <p>
            <!--
        <div class="row">
            <div class="input-field col s24" Style="height: 10px; width: 100%; ">
                <span>Status:</span> 
            </div>
            
            <div class="input-field col s3">
                <label>
                    <input class="with-gap" name="group1" type="radio" checked />
                    <span>Em Andamento</span>
                </label>
            </div>
            </p>
            <p>
                
            <div class="input-field col s3">
                <label>
                    <input class="with-gap" name="group1" type="radio" />
                    <span>Concluído</span>
                </label>
            </div>
            </p>
            <p>
            <div class="input-field col s3">    
                <label>
                    <input class="with-gap" name="group1" type="radio"  />
                    <span>Cancelado</span>
                </label>
            </div>
            </p>  
                          
        </div>
    -->
        <div id="btncancel"  class="input-field col s12">
           
            <button id="btbtncancelnCanc1" class="btn waves-effect waves-light red accent-4" type="submit" name="action" onClick="CancelaAddMeta()" >Cancelar
                <i class=" material-icons right" ></i>
            </button>
            <button id="btnInc" class="btn waves-effect waves-light " type="submit" name="action" onclick="SalvarMeta()" >Salvar
                <i class="material-icons right">send</i>
            </button>
        </div>
    </form>
    </div>

    <div id="paginaAlt" hidden="true">
    <form action="#">                                                                                                       
        <div id="tela3" class="row">                                                                               
            <div  class="input-field col s12">                                                            
              <input placeholder="Meta" id="inputAlteraMeta" type="text" class="validate">
              <label for="alterarmeta">Meta:</label>
            </div>
            <div class="input-field col s12">
              <input style="width:25%" id="inputAlterainicio" type="date" class="validate">
              <label for="alterainicio">Previsão de Inicio:</label>
            </div>
          </div>
        <p>
        <div class="row">
            <div class="input-field col s24" Style="height: 10px; width: 100%; ">
                <span>Status:</span> 
            </div>
            
            <div class="input-field col s3">
                <label>
                    <input class="with-gap" name="group1" type="radio" checked />
                    <span>Em Andamento</span>
                </label>
            </div>
            </p>
            <p>
            <div class="input-field col s3">
                <label>
                    <input class="with-gap" name="group1" type="radio" />
                    <span>Concluído</span>
                </label>
            </div>
            </p>
            <p>
            <div class="input-field col s3">    
                <label>
                    <input class="with-gap" name="group1" type="radio"  />
                    <span>Cancelado</span>
                </label>
            </div>
            </p>                
        </div>
        <div class="input-field col s12">
           
            <button class="btn waves-effect waves-light red accent-4" type="submit" name="action">Cancelar
                <i class=" material-icons right"></i>
                
            </button>
            <button class="btn waves-effect waves-light " type="submit" name="action" disabled>Salvar
                <i class="material-icons right">send</i>
            </button>
            
        </div>   
    </form>
</div>
    <!--JavaScript at end of body for optimized loading-->
    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script type="text/javascript">
    //console.log("Helen arrasadora de cód");
    let paginaInicial= document.getElementById("paginaInicial")//[0].classList.remove(""); 
   

    paginaInicial.removeAttribute("hidden");

    //vai para a página de cadastro de Metas
    function AddMeta(){
       
       let paginaCadastro = document.getElementById("paginaCad")//[0].classList.remove(""); 
       paginaCadastro.removeAttribute("hidden");

       paginaInicial.setAttribute("hidden", "true");
       
    }
    function CancelaAddMeta(){
        let paginaInicial = document.getElementById("paginaInicial")
      paginaInicial.removeAttribute("hidden");

      let paginaCadastro= document.getElementById("paginaCad")
      
      paginaCadastro.setAttribute("hidden", "true");
    }

    function InicialAddMeta(){
        let paginaInicial = document.getElementById("paginaInicial")
      paginaInicial.removeAttribute("hidden");

      let paginaCadastro= document.getElementById("paginaCad")
      
      paginaCadastro.setAttribute("hidden", "true");
    }
 
    function SalvarMeta(){
    
        console.log("salvar")
        
            let Meta = document.getElementById("inputNovaMeta").value;
            console.log(Meta)
            let Data = document.getElementById("inputNovoInicio").value;
            console.log(Data)
            let Status = document.getElementById("inputNovoInicio").value;
            let dataInicio= new Date (Data) 
            
            //console.log(dataAmericana)


            if (Meta==null ||  Meta== ""){
                alert("Meta vazia favor preencher!");
                return;
            }
            if (dataInicio== "Invalid Date" ){
                alert("Data vazia favor preencher!"); 
                return;
            }
            adicionaMetas ();

        //return
        let paginaInicial = document.getElementById("paginaInicial")
      paginaInicial.removeAttribute("hidden");

      let paginaCadastro= document.getElementById("paginaCad")
      
      paginaCadastro.setAttribute("hidden", "true");
    }

    </script> 
    <script type="text/javascript">

      let metas = [];
      //pega as metas locais
      onload = () => {
        const metaslocais = JSON.parse(localStorage.getItem('metas'));
        if (metaslocais) metas = metaslocais;
        alert(metas.length + " metas carregadas ")
      }


      const adicionaMetas = () => {
        let campo = document.querySelector('#inputNovaMeta');
        //alert(campo.value);
        let descricaoMeta = campo.value;
        let descricaoDataInicio = campo.value;
        metas.push({
          id: Math.random().toString().replace('0.', ''),
          descricaoMeta: descricaoMeta, 
          descricaoMeta: descricaoMeta,
        });
        
        campo.value = '';
          salvaMetas();
          mostraMetas();
        
      };
      const salvaMetas = () => {
        localStorage.setItem('metas', JSON.stringify(metas));
      };

      const mostraMetas = () => {
        const listaDeMetas = document.querySelector('#listaDeTarefas');
        listaDeMetas.innerHTML = '';
        metas.forEach((t) => {
          let elemMeta = document.createElement('li');
          lemMeta.innerHTML = metaslocais.descricao;
          lemMeta.setAttribute('data-id', metaslocais.id);

        //   elemTarefa.onclick = () => {
        //     let campo = document.querySelector('#inputAlteraTarefa');
        //     ativa('tela3');
        //     campo.value = t.descricao;
        //     campo.setAttribute('data-id', t.id);
        //     campo.focus();
        //   };
        //   listaDeTarefas.appendChild(elemTarefa);
        // });
    
    </script>
  </body>
</html>